{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.dev/schema/passportSealed.schema.json",
  "title": "Vehicle Passport (Sealed)",
  "type": "object",

  "allOf": [
    { "$ref": "https://example.dev/schema/passportDraft.schema.json" },
    {
      "type": "object",
      "properties": {
        "seal": {
          "type": "object",
          "additionalProperties": false,
          "required": ["hash", "sig", "key_id", "sealed_ts"],
          "properties": {
            "hash": { "type": "string", "pattern": "^[a-f0-9]{64}$" },
            "sig":  { "type": "string" },
            "key_id": { "type": "string" },
            "sealed_ts": { "type": "string", "format": "date-time" }
          }
        }
      },
      "required": ["seal"]
    }
  ],

  "unevaluatedProperties": false
}
